import{_ as I,a5 as N,r as R,s as $,x as A,A as E,Y as L,C as c,D as f,o as s,F as o,a6 as M,H as V,Q as D,J as r,P as _,E as w,O as H,G as O,K as u,a3 as T,a4 as U,L as x,N as b,a1 as j,a2 as z}from"./index-25cb404b.js";import{c as G,f as J,u as K,e as Q,V as Y}from"./index.esm-61b7aa23.js";import{V as W,b as X,a as v}from"./VRow-967ca939.js";import{V as Z,a as ee}from"./VCarouselItem-878ffeac.js";import"./ssrBoot-747246da.js";const d=i=>(j("data-v-64741959"),i=i(),z(),i),te={class:"my-3",style:{"white-space":"pre"}},ae=d(()=>r("div",null," ",-1)),se=d(()=>r("div",null," ",-1)),oe=d(()=>r("h1",{class:"textdown"},"已下架",-1)),le=d(()=>r("div",null," ",-1)),re={__name:"ProductView",setup(i){const C=N(),g=R(),{api:S,apiAuth:k}=D(),m=$(),h=A(),t=E({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""}),B=G({quantity:J().typeError("格式錯誤").required("缺少數量").min(1,"數量最少為 1")}),{isSubmitting:y,handleSubmit:q}=K({validationSchema:B,initialValues:{quantity:1}}),p=Q("quantity"),P=q(async n=>{var l,e;if(!h.isLogin){g.push("/login");return}try{const{data:a}=await k.patch("/users/cart",{product:t.value._id,quantity:n.quantity});h.cart=a.result,m({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:1500,color:"#8C8987",location:"center"}})}catch(a){console.log(a);const F=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"發生錯誤，請稍後再試";m({text:F,showCloseButton:!1,snackbarProps:{timeout:1500,color:"error",location:"center"}})}});return L(async()=>{var n,l;try{const{data:e}=await S.get("/products/"+C.params._id);t.value._id=e.result._id,t.value.name=e.result.name,t.value.price=e.result.price,t.value.description=e.result.description,t.value.image=e.result.image,t.value.sell=e.result.sell,t.value.category=e.result.category,document.title=`出來喬師傅 | ${t.value.name}`}catch(e){console.log(e);const a=((l=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";m({text:a,showCloseButton:!1,snackbarProps:{timeout:1500,color:"error",location:"center"}}),g.push("/")}}),(n,l)=>(c(),f(V,null,[s(W,null,{default:o(()=>[s(X,null,{default:o(()=>[s(v,{class:"titel",cols:"12"},{default:o(()=>[r("h1",null,_(t.value.name),1)]),_:1}),s(v,{cols:"12",md:"6"},{default:o(()=>[t.value.image&&t.value.image.length>0?(c(),w(Z,{key:0,"show-arrows":"hover","hide-delimiters":"",progress:"#403635"},{default:o(()=>[(c(!0),f(V,null,H(t.value.image,(e,a)=>(c(),w(ee,{key:a,src:e},null,8,["src"]))),128))]),_:1})):O("",!0)]),_:1}),s(v,{class:"my-auto",cols:"12",md:"6"},{default:o(()=>[r("h2",null,"1HR   $ "+_(t.value.price),1),r("p",te,_(t.value.description),1),ae,s(Y,{disabled:u(y),onSubmit:T(u(P),["prevent"])},{default:o(()=>[s(U,{type:"text",inputmode:"numeric",min:"0",modelValue:u(p).value.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u(p).value.value=e),"error-messages":u(p).errorMessage.value,clearable:"",variant:"outlined",style:{width:"300px"}},null,8,["modelValue","error-messages"]),se,s(x,{class:"cart-btn",type:"submit","prepend-icon":"mdi-cart",loading:u(y)},{default:o(()=>[b("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),s(M,{class:"align-center justify-center text-center","model-value":!t.value.sell,persistent:""},{default:o(()=>[oe,le,s(x,{class:"color",to:"/",block:"",rounded:"xl",elevation:"20",size:"x-large"},{default:o(()=>[b("回首頁")]),_:1})]),_:1},8,["model-value"])],64))}},me=I(re,[["__scopeId","data-v-64741959"]]);export{me as default};
